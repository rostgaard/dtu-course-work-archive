<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>02333 Task 2: src/kernel/kernel.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<h1>src/kernel/kernel.h</h1><a href="kernel_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*!</span>
<a name="l00002"></a>00002 <span class="comment"> * \file kernel.h</span>
<a name="l00003"></a>00003 <span class="comment">   This file holds kernel wide macros and declarations.</span>
<a name="l00004"></a>00004 <span class="comment"></span>
<a name="l00005"></a>00005 <span class="comment"> */</span>
<a name="l00006"></a>00006 
<a name="l00007"></a>00007 <span class="preprocessor">#ifndef _KERNEL_H_</span>
<a name="l00008"></a>00008 <span class="preprocessor"></span><span class="preprocessor">#define _KERNEL_H_</span>
<a name="l00009"></a>00009 <span class="preprocessor"></span>
<a name="l00010"></a>00010 
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;<a class="code" href="sysdefines_8h.html" title="This file defines constants used by system calls.">sysdefines.h</a>&gt;</span>
<a name="l00012"></a>00012 
<a name="l00013"></a>00013 <span class="comment">/* Type definitions */</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="comment">/* Macros */</span>
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="kernel_8h.html#6575dcab992f58c103eca3bb0c4e8cb3">00017</a> <span class="preprocessor">#define SYSCALL_ARGUMENTS (thread_table[current_thread].data.registers.\</span>
<a name="l00018"></a>00018 <span class="preprocessor">                           integer_registers)</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span><span class="comment">/*!&lt; Macro used in the system call switch to access the arguments to the</span>
<a name="l00020"></a>00020 <span class="comment">     system call. */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a><a class="code" href="kernel_8h.html#02a011ae232d9bd03776f3a57d95cf89">00022</a> <span class="preprocessor">#define KERNEL_VERSION          (0x0000000100000000)</span>
<a name="l00023"></a>00023 <span class="preprocessor"></span><span class="comment">/*!&lt; Kernel version number. */</span>
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="kernel_8h.html#57c4c2d31ce05f6034d5356eb9e366f2">00025</a> <span class="preprocessor">#define MAX_NUMBER_OF_PROCESSES (16)</span>
<a name="l00026"></a>00026 <span class="preprocessor"></span><span class="comment">/*!&lt; Size of the process_table. */</span>
<a name="l00027"></a><a class="code" href="kernel_8h.html#d6cc4ecdab4463bddad5f348be7108fc">00027</a> <span class="preprocessor">#define MAX_NUMBER_OF_THREADS   (256)</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="comment">/*!&lt; Size of the thread_table. */</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="comment">/* Type declarations */</span>
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">/*! Defines an execution context. */</span>
<a name="l00033"></a><a class="code" href="structcontext.html">00033</a> <span class="keyword">struct </span><a class="code" href="structcontext.html" title="Defines an execution context.">context</a>
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035  <span class="keywordtype">char</span>     <a class="code" href="structcontext.html#6631401900ecc771a3c9dc3e3ca4194e" title="Stores the fpu/mmx/sse registers.">fpu_context</a>[512];<span class="comment"></span>
<a name="l00036"></a><a class="code" href="structcontext.html#6631401900ecc771a3c9dc3e3ca4194e">00036</a> <span class="comment"> /*!&lt; Stores the fpu/mmx/sse registers */</span>
<a name="l00037"></a>00037  <span class="keyword">struct</span>
<a name="l00038"></a>00038  {
<a name="l00039"></a><a class="code" href="structcontext.html#24aa932cc08c8f090974663aee8cb590">00039</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#24aa932cc08c8f090974663aee8cb590">rax</a>;
<a name="l00040"></a><a class="code" href="structcontext.html#d14dea947daaa47a6448eda2b815e88b">00040</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#d14dea947daaa47a6448eda2b815e88b">rbx</a>;
<a name="l00041"></a><a class="code" href="structcontext.html#a60aec8b6a9d05e94f985195696b3a68">00041</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#a60aec8b6a9d05e94f985195696b3a68">rcx</a>;
<a name="l00042"></a><a class="code" href="structcontext.html#067b080e9e416b6ed41e707f7f1cfb8d">00042</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#067b080e9e416b6ed41e707f7f1cfb8d">rdx</a>;
<a name="l00043"></a><a class="code" href="structcontext.html#68a2a19852e813ddfbb082bcf77a455c">00043</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#68a2a19852e813ddfbb082bcf77a455c">rdi</a>;
<a name="l00044"></a><a class="code" href="structcontext.html#64d66224d8b305184b07eb06dc60f134">00044</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#64d66224d8b305184b07eb06dc60f134">rsi</a>;
<a name="l00045"></a><a class="code" href="structcontext.html#16f4817d6c0c73ee4c0cdb5aaad595fc">00045</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#16f4817d6c0c73ee4c0cdb5aaad595fc">rbp</a>;
<a name="l00046"></a><a class="code" href="structcontext.html#b1221726a300db413f0a06ab73fe2a5c">00046</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#b1221726a300db413f0a06ab73fe2a5c">rsp</a>;
<a name="l00047"></a><a class="code" href="structcontext.html#b6a97c443ac6b824f53ca3a91ee4b422">00047</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#b6a97c443ac6b824f53ca3a91ee4b422">r8</a>;
<a name="l00048"></a><a class="code" href="structcontext.html#e1f4b26b1fd22fe0a2faf7900e768441">00048</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#e1f4b26b1fd22fe0a2faf7900e768441">r9</a>;
<a name="l00049"></a><a class="code" href="structcontext.html#a1a0a0545765163f058aa6ed84015b7e">00049</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#a1a0a0545765163f058aa6ed84015b7e">r10</a>;
<a name="l00050"></a><a class="code" href="structcontext.html#7536d17fedcd4fb2be991575caf9c4e9">00050</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#7536d17fedcd4fb2be991575caf9c4e9">r11</a>;
<a name="l00051"></a><a class="code" href="structcontext.html#d4afb08136bc101b79f63c08d9cef21a">00051</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#d4afb08136bc101b79f63c08d9cef21a">r12</a>;
<a name="l00052"></a><a class="code" href="structcontext.html#5775261579e35bdd6d2b5f3f434145e3">00052</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#5775261579e35bdd6d2b5f3f434145e3">r13</a>;
<a name="l00053"></a><a class="code" href="structcontext.html#80c7444135d9be8047261cd404324d10">00053</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#80c7444135d9be8047261cd404324d10">r14</a>;
<a name="l00054"></a><a class="code" href="structcontext.html#0c1aa3d6077a5e1f1fa6b67ba2fb64bf">00054</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#0c1aa3d6077a5e1f1fa6b67ba2fb64bf">r15</a>;
<a name="l00055"></a><a class="code" href="structcontext.html#b7dcdaab21ef5db05aa8f2bf67c9a025">00055</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#b7dcdaab21ef5db05aa8f2bf67c9a025" title="status flags">rflags</a>;       <span class="comment">/*!&lt; status flags */</span>
<a name="l00056"></a><a class="code" href="structcontext.html#63fbab25a27461e7fe08f091d8c7fcea">00056</a>   <span class="keywordtype">long</span>    <a class="code" href="structcontext.html#63fbab25a27461e7fe08f091d8c7fcea" title="instruction pointer">rip</a>;          <span class="comment">/*!&lt; instruction pointer */</span>
<a name="l00057"></a>00057  }        <a class="code" href="structcontext.html#2231e85bf6127f1385722ff6152f8229" title="Stores all user visible integer registers.">integer_registers</a>;<span class="comment"></span>
<a name="l00058"></a>00058 <span class="comment"> /*!&lt; Stores all user visible integer registers. The segment registers are not</span>
<a name="l00059"></a>00059 <span class="comment">      stored as the user mode processes can only use a code and a data segment</span>
<a name="l00060"></a>00060 <span class="comment">      descriptor. We assume that the cs is set to the code and all the rest</span>
<a name="l00061"></a>00061 <span class="comment">      of the segment registers are set to the data segment all the time. */</span>
<a name="l00062"></a>00062 };
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="comment"></span>
<a name="l00065"></a>00065 <span class="comment">/*! Defines a thread. */</span>
<a name="l00066"></a><a class="code" href="unionthread.html">00066</a> <span class="keyword">union </span><a class="code" href="unionthread.html" title="Defines a thread.">thread</a>
<a name="l00067"></a>00067 {
<a name="l00068"></a>00068  <span class="keyword">struct</span>
<a name="l00069"></a>00069  {
<a name="l00070"></a><a class="code" href="unionthread.html#18417096a1dce3449fb1545327dc4a3a">00070</a>   <span class="keyword">struct </span><a class="code" href="structcontext.html" title="Defines an execution context.">context</a> <a class="code" href="unionthread.html#18417096a1dce3449fb1545327dc4a3a" title="The context of the thread.">registers</a>;     <span class="comment">/*!&lt; The context of the thread. Note: the</span>
<a name="l00071"></a>00071 <span class="comment">                                     context of the thread could include more</span>
<a name="l00072"></a>00072 <span class="comment">                                     than the accessible registers. */</span>
<a name="l00073"></a><a class="code" href="unionthread.html#5a9a6213b76bb2ec6933dce145c7be75">00073</a>   <span class="keywordtype">int</span>            <a class="code" href="unionthread.html#5a9a6213b76bb2ec6933dce145c7be75" title="The index identifies the process that owns this thread.">owner</a>;         <span class="comment">/*!&lt; The index identifies the process that owns</span>
<a name="l00074"></a>00074 <span class="comment">                                     this thread. The owner can be retrieved from</span>
<a name="l00075"></a>00075 <span class="comment">                                     the process_table by using the index.  */</span>
<a name="l00076"></a>00076  }               <a class="code" href="unionthread.html#4932471bd15a1590d98e771cd637fee6">data</a>;
<a name="l00077"></a><a class="code" href="unionthread.html#6e5a24597363ff2d3d995449db0f2c13">00077</a>  <span class="keywordtype">char</span>            <a class="code" href="unionthread.html#6e5a24597363ff2d3d995449db0f2c13">padding</a>[1024];
<a name="l00078"></a>00078 };
<a name="l00079"></a>00079 <span class="comment"></span>
<a name="l00080"></a>00080 <span class="comment">/*! Defines a process. */</span>
<a name="l00081"></a><a class="code" href="structprocess.html">00081</a> <span class="keyword">struct </span><a class="code" href="structprocess.html" title="Defines a process.">process</a>
<a name="l00082"></a>00082 {
<a name="l00083"></a><a class="code" href="structprocess.html#0760ed76634bed942c0ed8b01760e163">00083</a>  <span class="keywordtype">int</span>             <a class="code" href="structprocess.html#0760ed76634bed942c0ed8b01760e163" title="The number of threads running in this process.">threads</a>;        <span class="comment">/*!&lt; The number of threads running in this</span>
<a name="l00084"></a>00084 <span class="comment">                                      process. */</span>
<a name="l00085"></a><a class="code" href="structprocess.html#f6c32869d011d1277ca01a4ac3cacc36">00085</a>  <span class="keywordtype">int</span>             <a class="code" href="structprocess.html#f6c32869d011d1277ca01a4ac3cacc36" title="This is an index into process_table.">parent</a>;         <span class="comment">/*!&lt; This is an index into process_table. The</span>
<a name="l00086"></a>00086 <span class="comment">                                      index corresponds to the parent process. */</span>
<a name="l00087"></a>00087 };
<a name="l00088"></a>00088 
<a name="l00089"></a>00089 <span class="comment">/* ELF image structures. The names from the ELF64 specification are used and</span>
<a name="l00090"></a>00090 <span class="comment">   the structs are derived from the ELF64 specification. */</span>
<a name="l00091"></a>00091 
<a name="l00092"></a><a class="code" href="kernel_8h.html#ba717f40a418b0d99c2efd4cdab4f54f">00092</a> <span class="preprocessor">#define EI_MAG0       0  </span><span class="comment">/*!&lt; The first four bytes in an ELF image is</span>
<a name="l00093"></a>00093 <span class="comment">                              0x7f 'E' 'L' 'F'. */</span>
<a name="l00094"></a><a class="code" href="kernel_8h.html#2cae3878d982911632b418680718d53b">00094</a> <span class="preprocessor">#define EI_MAG1       1</span>
<a name="l00095"></a><a class="code" href="kernel_8h.html#2884a339ef7aefee59d160ed3fbb1739">00095</a> <span class="preprocessor"></span><span class="preprocessor">#define EI_MAG2       2</span>
<a name="l00096"></a><a class="code" href="kernel_8h.html#ce03d4c5e8952e27b8505581432c3b84">00096</a> <span class="preprocessor"></span><span class="preprocessor">#define EI_MAG3       3</span>
<a name="l00097"></a><a class="code" href="kernel_8h.html#5b508cacf6662e4bc0e98ffe1eb61636">00097</a> <span class="preprocessor"></span><span class="preprocessor">#define EI_CLASS      4  </span><span class="comment">/*!&lt; The specific ELF image class. */</span>
<a name="l00098"></a><a class="code" href="kernel_8h.html#79c714b4bf89638ff576e163d7d2144f">00098</a> <span class="preprocessor">#define EI_DATA       5  </span><span class="comment">/*!&lt; Describes if the image is big- or little-</span>
<a name="l00099"></a>00099 <span class="comment">                              endian. */</span>
<a name="l00100"></a><a class="code" href="kernel_8h.html#ac8694b14e6500d9dc5047ef62518845">00100</a> <span class="preprocessor">#define EI_VERSION    6  </span><span class="comment">/*!&lt; The version of the ELF specification the</span>
<a name="l00101"></a>00101 <span class="comment">                              image adheres to. */</span>
<a name="l00102"></a><a class="code" href="kernel_8h.html#862a7ea859a2a2bed110aedf7744d969">00102</a> <span class="preprocessor">#define EI_OSABI      7  </span><span class="comment">/*!&lt; Type of OS the image can be run on. */</span>
<a name="l00103"></a><a class="code" href="kernel_8h.html#72022210d08db2ebc18e6d785238871f">00103</a> <span class="preprocessor">#define EI_ABIVERSION 8  </span><span class="comment">/*!&lt; Version of the ABI used. */</span>
<a name="l00104"></a><a class="code" href="kernel_8h.html#ed24a379d553d0e36853949dd6ddd6c1">00104</a> <span class="preprocessor">#define EI_PAD        9  </span><span class="comment">/*!&lt; First unused byte in the identification array.</span>
<a name="l00105"></a>00105 <span class="comment">                          */</span>
<a name="l00106"></a><a class="code" href="kernel_8h.html#e407130db14180c6737390604ba7c1fe">00106</a> <span class="preprocessor">#define EI_NIDENT     16 </span><span class="comment">/*!&lt; Number of entries in the identification array */</span>
<a name="l00107"></a>00107 <span class="comment"></span>
<a name="l00108"></a>00108 <span class="comment">/*! Defines an ELF64 file header. */</span>
<a name="l00109"></a><a class="code" href="structElf64__Ehdr.html">00109</a> <span class="keyword">struct </span><a class="code" href="structElf64__Ehdr.html" title="Defines an ELF64 file header.">Elf64_Ehdr</a>
<a name="l00110"></a>00110 {
<a name="l00111"></a><a class="code" href="structElf64__Ehdr.html#cdd2e122af003c5b5708d1ae75b4a85c">00111</a>  <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> <a class="code" href="structElf64__Ehdr.html#cdd2e122af003c5b5708d1ae75b4a85c" title="Array of bytes that shows that this is an ELF image and what type of ELF image it...">e_ident</a>[<a class="code" href="kernel_8h.html#e407130db14180c6737390604ba7c1fe" title="Number of entries in the identification array.">EI_NIDENT</a>]; <span class="comment">/*!&lt; Array of bytes that shows that this</span>
<a name="l00112"></a>00112 <span class="comment">                                        is an ELF image and what type of ELF</span>
<a name="l00113"></a>00113 <span class="comment">                                        image it is. */</span>
<a name="l00114"></a><a class="code" href="structElf64__Ehdr.html#62550b6699bc7e76794cefce0ef835b6">00114</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#62550b6699bc7e76794cefce0ef835b6" title="The type of ELF executable image.">e_type</a>;             <span class="comment">/*!&lt; The type of ELF executable image. */</span>
<a name="l00115"></a><a class="code" href="structElf64__Ehdr.html#a9769e50876b340318739df8aad3da8a">00115</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#a9769e50876b340318739df8aad3da8a" title="Identifies the type of machine that the image can execute on.">e_machine</a>;          <span class="comment">/*!&lt; Identifies the type of machine that</span>
<a name="l00116"></a>00116 <span class="comment">                                        the image can execute on. */</span>
<a name="l00117"></a><a class="code" href="structElf64__Ehdr.html#76b2c9c412c0b1c18b5bce99c06fae9d">00117</a>  <span class="keywordtype">int</span>           <a class="code" href="structElf64__Ehdr.html#76b2c9c412c0b1c18b5bce99c06fae9d" title="The version of the ELF specification the image adheres to.">e_version</a>;          <span class="comment">/*!&lt; The version of the ELF specification the</span>
<a name="l00118"></a>00118 <span class="comment">                                        image adheres to. */</span>
<a name="l00119"></a><a class="code" href="structElf64__Ehdr.html#25d2234be9ba503e07b3bedde0827239">00119</a>  <span class="keywordtype">long</span>          <a class="code" href="structElf64__Ehdr.html#25d2234be9ba503e07b3bedde0827239" title="Start address of the executable.">e_entry</a>;            <span class="comment">/*!&lt; Start address of the executable. */</span>
<a name="l00120"></a><a class="code" href="structElf64__Ehdr.html#00a20bc6560455ed53f0df7fbde9fa99">00120</a>  <span class="keywordtype">long</span>          <a class="code" href="structElf64__Ehdr.html#00a20bc6560455ed53f0df7fbde9fa99" title="The offset into the image where the program header table is found.">e_phoff</a>;            <span class="comment">/*!&lt; The offset into the image where the</span>
<a name="l00121"></a>00121 <span class="comment">                                        program header table is found. */</span>
<a name="l00122"></a><a class="code" href="structElf64__Ehdr.html#492a3259c87a97850829e04b461e6767">00122</a>  <span class="keywordtype">long</span>          <a class="code" href="structElf64__Ehdr.html#492a3259c87a97850829e04b461e6767" title="The offset into the image where the program header table is found.">e_shoff</a>;            <span class="comment">/*!&lt; The offset into the image where the</span>
<a name="l00123"></a>00123 <span class="comment">                                        program header table is found. */</span>
<a name="l00124"></a><a class="code" href="structElf64__Ehdr.html#9f841df65d8a0f3c4e6ed4d4e87a535d">00124</a>  <span class="keywordtype">int</span>           <a class="code" href="structElf64__Ehdr.html#9f841df65d8a0f3c4e6ed4d4e87a535d" title="Flags that are machine specific.">e_flags</a>;            <span class="comment">/*!&lt; Flags that are machine specific.</span>
<a name="l00125"></a>00125 <span class="comment">                                        These can be used to differentiate</span>
<a name="l00126"></a>00126 <span class="comment">                                        between similar machines. */</span>
<a name="l00127"></a><a class="code" href="structElf64__Ehdr.html#62f38f678bb9ddf22412c43e37422110">00127</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#62f38f678bb9ddf22412c43e37422110" title="The size, in bytes, of the header.">e_ehsize</a>;           <span class="comment">/*!&lt; The size, in bytes, of the header. */</span>
<a name="l00128"></a><a class="code" href="structElf64__Ehdr.html#e865beb9d750185fa9ce5c3675b84b11">00128</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#e865beb9d750185fa9ce5c3675b84b11" title="The size, in bytes, of each entry in the program header table.">e_phentsize</a>;        <span class="comment">/*!&lt; The size, in bytes, of each entry in</span>
<a name="l00129"></a>00129 <span class="comment">                                        the program header table. */</span>
<a name="l00130"></a><a class="code" href="structElf64__Ehdr.html#dc0df3c64b26aa1181abec6ebab9d804">00130</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#dc0df3c64b26aa1181abec6ebab9d804" title="The size, in entries, of the program header table.">e_phnum</a>;            <span class="comment">/*!&lt; The size, in entries, of the program</span>
<a name="l00131"></a>00131 <span class="comment">                                        header table. */</span>
<a name="l00132"></a><a class="code" href="structElf64__Ehdr.html#69b3f9af019f287938fc5e77905a96bb">00132</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#69b3f9af019f287938fc5e77905a96bb" title="The size, in bytes, of each entry in the section header table.">e_shentsize</a>;        <span class="comment">/*!&lt; The size, in bytes, of each entry in</span>
<a name="l00133"></a>00133 <span class="comment">                                        the section header table. */</span>
<a name="l00134"></a><a class="code" href="structElf64__Ehdr.html#394daf76f5bbf0380d2f4289a8515430">00134</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#394daf76f5bbf0380d2f4289a8515430" title="The size, in entries, of the section header table.">e_shnum</a>;            <span class="comment">/*!&lt; The size, in entries, of the section</span>
<a name="l00135"></a>00135 <span class="comment">                                        header table. */</span>
<a name="l00136"></a><a class="code" href="structElf64__Ehdr.html#a21de5fc02ed12582c5a1cb7d3b802ed">00136</a>  <span class="keywordtype">short</span>         <a class="code" href="structElf64__Ehdr.html#a21de5fc02ed12582c5a1cb7d3b802ed" title="The index, into the section table, of the section name string table.">e_shstrndx</a>;         <span class="comment">/*!&lt; The index, into the section table,</span>
<a name="l00137"></a>00137 <span class="comment">                                        of the section name string table.*/</span>
<a name="l00138"></a>00138 };
<a name="l00139"></a>00139 <span class="comment"></span>
<a name="l00140"></a>00140 <span class="comment">/*! Defines an entry in the ELF program header table. Each entry corresponds</span>
<a name="l00141"></a>00141 <span class="comment">    to a segment. */</span>
<a name="l00142"></a><a class="code" href="structElf64__Phdr.html">00142</a> <span class="keyword">struct </span><a class="code" href="structElf64__Phdr.html" title="Defines an entry in the ELF program header table.">Elf64_Phdr</a>
<a name="l00143"></a>00143 {
<a name="l00144"></a><a class="code" href="structElf64__Phdr.html#a04c13b62e12c63186baad3ff9abb4f3">00144</a>  <span class="keywordtype">int</span>  <a class="code" href="structElf64__Phdr.html#a04c13b62e12c63186baad3ff9abb4f3" title="Segments can have several types.">p_type</a>;   <span class="comment">/*!&lt; Segments can have several types. p_type holds the type. */</span>
<a name="l00145"></a><a class="code" href="structElf64__Phdr.html#25bc658c1d4dd015ca9a2ac2e11b0421">00145</a>  <span class="keywordtype">int</span>  <a class="code" href="structElf64__Phdr.html#25bc658c1d4dd015ca9a2ac2e11b0421" title="The attribute flags of the segment.">p_flags</a>;  <span class="comment">/*!&lt; The attribute flags of the segment. */</span>
<a name="l00146"></a><a class="code" href="structElf64__Phdr.html#61c36ae53c0db6db28e096f26e790a2c">00146</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#61c36ae53c0db6db28e096f26e790a2c" title="Offset into the image of the first byte of the segment.">p_offset</a>; <span class="comment">/*!&lt; Offset into the image of the first byte of the</span>
<a name="l00147"></a>00147 <span class="comment">                     segment */</span>
<a name="l00148"></a><a class="code" href="structElf64__Phdr.html#860acfa0e2c8916d4b0da125e8bf4a0a">00148</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#860acfa0e2c8916d4b0da125e8bf4a0a" title="The (virtual) address to which the segment is to be loaded.">p_vaddr</a>;  <span class="comment">/*!&lt; The (virtual) address to which the segment is to be</span>
<a name="l00149"></a>00149 <span class="comment">                     loaded. */</span>
<a name="l00150"></a><a class="code" href="structElf64__Phdr.html#0eeccab88011cb88999cbc24071efb26">00150</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#0eeccab88011cb88999cbc24071efb26" title="Not used.">p_paddr</a>;  <span class="comment">/*!&lt; Not used. */</span>
<a name="l00151"></a><a class="code" href="structElf64__Phdr.html#6d1343d69edda70076a0f6ccef2612ff">00151</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#6d1343d69edda70076a0f6ccef2612ff" title="The number of bytes the segment occupies in the image.">p_filesz</a>; <span class="comment">/*!&lt; The number of bytes the segment occupies in the</span>
<a name="l00152"></a>00152 <span class="comment">                     image. */</span>
<a name="l00153"></a><a class="code" href="structElf64__Phdr.html#36687ef66003f18ca6efb2015c86eec3">00153</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#36687ef66003f18ca6efb2015c86eec3" title="The number of bytes the segment occupies in memory.">p_memsz</a>;  <span class="comment">/*!&lt; The number of bytes the segment occupies in memory. */</span>
<a name="l00154"></a><a class="code" href="structElf64__Phdr.html#7e100e0643ecdd2b21de62fed5491a56">00154</a>  <span class="keywordtype">long</span> <a class="code" href="structElf64__Phdr.html#7e100e0643ecdd2b21de62fed5491a56" title="The alignment the segment should have in memory.">p_align</a>;  <span class="comment">/*!&lt; The alignment the segment should have in memory. This</span>
<a name="l00155"></a>00155 <span class="comment">                     field is currently being ignored. */</span>
<a name="l00156"></a>00156 };
<a name="l00157"></a>00157 
<a name="l00158"></a>00158 
<a name="l00159"></a>00159 <span class="comment">/* Values used in p_type */</span>
<a name="l00160"></a><a class="code" href="kernel_8h.html#854729c1dc4623abeaeb765a1b745012">00160</a> <span class="preprocessor">#define PT_NULL 0 </span><span class="comment">/*!&lt; The entry is not used. */</span>
<a name="l00161"></a><a class="code" href="kernel_8h.html#84d7768fd6c6ece599d297090900cf92">00161</a> <span class="preprocessor">#define PT_LOAD 1 </span><span class="comment">/*!&lt; The segment can be loaded into memory. */</span>
<a name="l00162"></a><a class="code" href="kernel_8h.html#58ff00be749ca4000074f9b9066a1056">00162</a> <span class="preprocessor">#define PT_PHDR 6 </span><span class="comment">/*!&lt; The segment only hold a program header table. */</span>
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 <span class="comment">/* Values used in p_flags */</span>
<a name="l00165"></a><a class="code" href="kernel_8h.html#1780bfb8eae34d26e52459699877c640">00165</a> <span class="preprocessor">#define PF_X        0x1        </span><span class="comment">/*!&lt; Segment can be executed.*/</span>
<a name="l00166"></a><a class="code" href="kernel_8h.html#20892094358e21f49ab6e5f8c4e29ae6">00166</a> <span class="preprocessor">#define PF_W        0x2        </span><span class="comment">/*!&lt; Segment can be written. */</span>
<a name="l00167"></a><a class="code" href="kernel_8h.html#e529f935e58c029768c06fbc98b2ba8c">00167</a> <span class="preprocessor">#define PF_R        0x4        </span><span class="comment">/*!&lt; Segment can be read. */</span>
<a name="l00168"></a><a class="code" href="kernel_8h.html#ce0c7d6f4b9a1e618142f874ac089ea2">00168</a> <span class="preprocessor">#define PF_MASKPERM 0x0000FFFF </span><span class="comment">/*!&lt; Used to mask the permission bits */</span>
<a name="l00169"></a>00169 
<a name="l00170"></a>00170 <span class="comment">/* Data structures describing the executable images embedded in the kernel</span>
<a name="l00171"></a>00171 <span class="comment">   image. */</span>
<a name="l00172"></a>00172 <span class="comment"></span>
<a name="l00173"></a>00173 <span class="comment">/*! Defines an executable program. */</span>
<a name="l00174"></a><a class="code" href="structexecutable.html">00174</a> <span class="keyword">struct </span><a class="code" href="structexecutable.html" title="Defines an executable program.">executable</a>
<a name="l00175"></a>00175 {
<a name="l00176"></a><a class="code" href="structexecutable.html#a1c86d7cf702384851c111da50191a59">00176</a>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structElf64__Ehdr.html" title="Defines an ELF64 file header.">Elf64_Ehdr</a>* <a class="code" href="structexecutable.html#a1c86d7cf702384851c111da50191a59" title="The start of the ELF file header.">elf_image</a>;             <span class="comment">/*!&lt; The start of the ELF</span>
<a name="l00177"></a>00177 <span class="comment">                                                      file header. */</span>
<a name="l00178"></a><a class="code" href="structexecutable.html#6ecb84407cf0842ab90179cb63ff7fca">00178</a>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>            <a class="code" href="structexecutable.html#6ecb84407cf0842ab90179cb63ff7fca" title="Size in bytes of the program&amp;#39;s memory foot print when loaded.">memory_footprint_size</a>; <span class="comment">/*!&lt; Size in bytes of the</span>
<a name="l00179"></a>00179 <span class="comment">                                                      program's memory foot</span>
<a name="l00180"></a>00180 <span class="comment">                                                      print when loaded. */</span>
<a name="l00181"></a>00181 };
<a name="l00182"></a>00182 <span class="comment"></span>
<a name="l00183"></a>00183 <span class="comment">/*! Defines an executable image embedded into the kernel image. The executable</span>
<a name="l00184"></a>00184 <span class="comment">    images are linked together into a linked list. The linked list is built at</span>
<a name="l00185"></a>00185 <span class="comment">    link time, see the kernel link script. */</span>
<a name="l00186"></a><a class="code" href="structexecutable__image.html">00186</a> <span class="keyword">struct </span><a class="code" href="structexecutable__image.html" title="Defines an executable image embedded into the kernel image.">executable_image</a>
<a name="l00187"></a>00187 {
<a name="l00188"></a><a class="code" href="structexecutable__image.html#ec011f807d131e393d76645f40e9f3b1">00188</a>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structexecutable__image.html" title="Defines an executable image embedded into the kernel image.">executable_image</a>* <span class="keyword">const</span> <a class="code" href="structexecutable__image.html#ec011f807d131e393d76645f40e9f3b1" title="Points to the next executable image.">next</a>; <span class="comment">/*!&lt; Points to the next</span>
<a name="l00189"></a>00189 <span class="comment">                                                 executable image. The last</span>
<a name="l00190"></a>00190 <span class="comment">                                                 executable image in the list</span>
<a name="l00191"></a>00191 <span class="comment">                                                 will have a next pointer</span>
<a name="l00192"></a>00192 <span class="comment">                                                 equal to 0, i.e., null. */</span>
<a name="l00193"></a><a class="code" href="structexecutable__image.html#5f739bc421c5934bdb5f93a8efbbf9de">00193</a>  <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structElf64__Ehdr.html" title="Defines an ELF64 file header.">Elf64_Ehdr</a>              <a class="code" href="structexecutable__image.html#5f739bc421c5934bdb5f93a8efbbf9de" title="The ELF image file header.">elf_image</a>; <span class="comment">/*!&lt; The ELF image file header. */</span>
<a name="l00194"></a>00194 };
<a name="l00195"></a>00195 
<a name="l00196"></a>00196 <span class="comment">/* Variable declarations */</span>
<a name="l00197"></a>00197 
<a name="l00198"></a>00198 <span class="keyword">extern</span> <span class="keyword">union </span><a class="code" href="unionthread.html" title="Defines a thread.">thread</a>
<a name="l00199"></a>00199 <a class="code" href="kernel_8c.html#6dc391e749c9e7d34ba9016cf33b53e7" title="Array holding all threads in the systems.">thread_table</a>[<a class="code" href="kernel_8h.html#d6cc4ecdab4463bddad5f348be7108fc" title="Size of the thread_table.">MAX_NUMBER_OF_THREADS</a>];<span class="comment"></span>
<a name="l00200"></a>00200 <span class="comment">/*!&lt; Array holding all threads in the systems. */</span>
<a name="l00201"></a>00201 
<a name="l00202"></a>00202 <span class="keyword">extern</span> <span class="keyword">struct </span><a class="code" href="structprocess.html" title="Defines a process.">process</a>
<a name="l00203"></a>00203 <a class="code" href="kernel_8c.html#f0a8e912e96fe0f53892b1a7b1d93ee6" title="Array holding all processes in the system.">process_table</a>[<a class="code" href="kernel_8h.html#57c4c2d31ce05f6034d5356eb9e366f2" title="Size of the process_table.">MAX_NUMBER_OF_PROCESSES</a>];<span class="comment"></span>
<a name="l00204"></a>00204 <span class="comment">/*!&lt; Array holding all processes in the system. */</span>
<a name="l00205"></a>00205 
<a name="l00206"></a>00206 
<a name="l00207"></a>00207 <span class="keyword">extern</span> <span class="keywordtype">int</span>
<a name="l00208"></a>00208 <a class="code" href="kernel_8c.html#d5b581172acec167e80c0d542c5605ed" title="The index, into thread_table, of the currently running thread.">current_thread</a>;<span class="comment"></span>
<a name="l00209"></a>00209 <span class="comment">/*!&lt; The index, into thread_table, of the currently running thread. */</span>
<a name="l00210"></a>00210 
<a name="l00211"></a>00211 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structexecutable__image.html" title="Defines an executable image embedded into the kernel image.">executable_image</a>* <span class="keyword">const</span>
<a name="l00212"></a>00212 <a class="code" href="kernel_8c.html#c5891f7fc423d94ccf39503ab01dc9d0" title="The first executable image in the linked list of executable images.">ELF_images_start</a>;<span class="comment"></span>
<a name="l00213"></a>00213 <span class="comment">/*!&lt; The first executable image in the linked list of executable images. */</span>
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span>
<a name="l00216"></a>00216 <a class="code" href="kernel_8c.html#d3985c7e28c14b14248eb5d3913783b8" title="The address of the first byte after the end of the last ELF image.">ELF_images_end</a>;<span class="comment"></span>
<a name="l00217"></a>00217 <span class="comment">/*!&lt; The address of the first byte after the end of the last ELF image. This</span>
<a name="l00218"></a>00218 <span class="comment">     variable is used for sanity checking. */</span>
<a name="l00219"></a>00219 
<a name="l00220"></a>00220 <span class="keyword">extern</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>
<a name="l00221"></a>00221 <a class="code" href="kernel_8c.html#edd7ec3de77747aee3449c8719eea737" title="The address of the first memory byte not used by any running process.">first_available_memory_byte</a>;<span class="comment"></span>
<a name="l00222"></a>00222 <span class="comment">/*!&lt; The address of the first memory byte not used by any running process.</span>
<a name="l00223"></a>00223 <span class="comment">     This variable is used to implement a crude memory allocation scheme. */</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 <span class="keyword">extern</span> <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>
<a name="l00226"></a>00226 <a class="code" href="kernel_8c.html#66be2e8afd6b7befb87d259df3856490" title="Size, in bytes, of the memory.">memory_size</a>;<span class="comment"></span>
<a name="l00227"></a>00227 <span class="comment">/*!&lt; Size, in bytes, of the memory. */</span>
<a name="l00228"></a>00228 
<a name="l00229"></a>00229 <span class="comment">/* Function declarations */</span>
<a name="l00230"></a>00230 <span class="comment"></span>
<a name="l00231"></a>00231 <span class="comment">/*! This function initializes the kernel after the assembly code portion has</span>
<a name="l00232"></a>00232 <span class="comment">    set the system and the CPU up. */</span>
<a name="l00233"></a>00233 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00234"></a>00234 <a class="code" href="kernel_8c.html#9efe22aaead3a5e936b5df459de02eba" title="This function initializes the kernel after the assembly code portion has set the...">initialize</a>(<span class="keywordtype">void</span>);
<a name="l00235"></a>00235 <span class="comment"></span>
<a name="l00236"></a>00236 <span class="comment">/*! This function gets called from the system call handler and responds to the</span>
<a name="l00237"></a>00237 <span class="comment">    system calls. */</span>
<a name="l00238"></a>00238 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00239"></a>00239 <a class="code" href="kernel_8h.html#c0e4400bb0e7b600b2670d5a68c15c7b" title="This function gets called from the system call handler and responds to the system...">system_call_handler</a>(<span class="keywordtype">void</span>);
<a name="l00240"></a>00240 <span class="comment"></span>
<a name="l00241"></a>00241 <span class="comment">/*! Outputs a string to the bochs console. */</span>
<a name="l00242"></a>00242 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00243"></a>00243 <a class="code" href="kernel_8c.html#76038da662be0fc9b74ae3c5210f2456" title="Outputs a string to the bochs console.">kprints</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* <span class="keyword">const</span> <span class="keywordtype">string</span><span class="comment"></span>
<a name="l00244"></a>00244 <span class="comment">        /*!&lt; points to a null terminated string */</span>
<a name="l00245"></a>00245         );
<a name="l00246"></a>00246 <span class="comment"></span>
<a name="l00247"></a>00247 <span class="comment">/*! Prints a long formatted as a hexadecimal number to the bochs console. */</span>
<a name="l00248"></a>00248 <span class="keyword">extern</span> <span class="keywordtype">void</span>
<a name="l00249"></a>00249 <a class="code" href="kernel_8c.html#43a7639c869aabcbadfa32e21cd270c0" title="Prints a long formatted as a hexadecimal number to the bochs console.">kprinthex</a>(<span class="keyword">const</span> <span class="keyword">register</span> <span class="keywordtype">long</span> value<span class="comment"></span>
<a name="l00250"></a>00250 <span class="comment">          /*!&lt; the value to be written */</span>);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252 <span class="preprocessor">#endif</span>
</pre></div></div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Feb 7 12:06:18 2010 for 02333 Task 2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
