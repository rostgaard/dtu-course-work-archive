The requirements on the processor dictates that a number of in- and output should be available. The values of these output is of course also to be respectively taken into account and verified.\\
By studying the description of desired product, it quickly becomes apparent that our process has to implement and contain a number of states. We will also be needing numerous registers and other RTL level components.\\\\
First, we would need to (re)set currency and counter registers to an initial value. Having a register count up when a coin is inserted would make no sense unless reset at appropriate times. This leaves us with an init state.


\subsection{Requirements analysis}
\label{sec:requirement_analysis}
By first doing a step-by-step analysis of the requirements, it becomes easier to implement every one of them in smaller steps.
\subsubsection*{Requirement 1}
The first requirement is that the machine should only be able to sell one type of product.\\
This is a requirement that actually simplifies the design, as it limits the user input we have to account for.

\subsubsection*{Requirement 2}
The machine dispenses one can at a time and dispenses as soon as the correct amount has been inserted.\\
This implies that we should do a transition to a dispense state if our amount is greater than or equal to the cost of one can.

\subsubsection*{Requirement 3}
The price must be changeable, though initially 7 kr.\\
By loading the cost into a register we could supply the cost via a bus. If the processor is implemented with an FPGA, it could also be specified in the VHDL code and then changed by rebuilding and reloading.

\subsubsection*{Requirement 4}
System accepts 1 and 2 Kr coins.\\
This can be implemented either by having a generic add state that does addition based on what coin was inserted, or by having separate states for adding 1 kr and adding 2 kr.

\subsubsection*{Requirement 5}
A display should show the total amount inserted.\\
This is solved by informal requirement described in section~\ref{sec:debug}. 

\subsubsection*{Requirement 6}
A LED should indicate if change is available.\\
In conjunction with requirement 4, this effectively becomes; the system should at least hold one 1 kr coin. 

\subsubsection*{Requirement 7}
The machine should close the coin slot until the product is removed. The original requirement is a bit ambiguous, as it state that the coin slot should be closed until the \emph{last} can has been removed. This contradicts requirement 1.\\
One way or the other, this gives us a wait state where we patiently wait for the user to remove the product.

\subsubsection*{Requirement 8}
The machine should be able to return change.\\
To detect if a user should receive change we need to able to detect if the amount of money inserted into the machine is more than cost of a product.

\subsubsection*{Requirement 9}
The user should at any time be able to cancel the purchase at any time up till the cost has been reached.\\

\subsubsection*{Requirement 10}
If change is not available, the machine should only accept purchases with the right amount.